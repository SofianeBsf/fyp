{
  "version": "5",
  "dialect": "mysql",
  "id": "f39372af-a804-4512-9d49-0e9fa58cc009",
  "prevId": "b18ba762-f2e5-4174-89a9-e68f83d60b0c",
  "tables": {
    "catalog_upload_jobs": {
      "name": "catalog_upload_jobs",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "filename": {
          "name": "filename",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "status": {
          "name": "status",
          "type": "enum('pending','processing','embedding','completed','failed')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'pending'"
        },
        "totalRows": {
          "name": "totalRows",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 0
        },
        "processedRows": {
          "name": "processedRows",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 0
        },
        "embeddedRows": {
          "name": "embeddedRows",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 0
        },
        "errorMessage": {
          "name": "errorMessage",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "uploadedBy": {
          "name": "uploadedBy",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "startedAt": {
          "name": "startedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "completedAt": {
          "name": "completedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "catalog_upload_jobs_id": {
          "name": "catalog_upload_jobs_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "evaluation_metrics": {
      "name": "evaluation_metrics",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "metricType": {
          "name": "metricType",
          "type": "enum('ndcg@10','recall@10','precision@10','mrr','custom')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "value": {
          "name": "value",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "queryCount": {
          "name": "queryCount",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 0
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "evaluatedAt": {
          "name": "evaluatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "evaluation_metrics_id": {
          "name": "evaluation_metrics_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "product_embeddings": {
      "name": "product_embeddings",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "productId": {
          "name": "productId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "embedding": {
          "name": "embedding",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "embeddingModel": {
          "name": "embeddingModel",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "'all-MiniLM-L6-v2'"
        },
        "textUsed": {
          "name": "textUsed",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "product_embeddings_id": {
          "name": "product_embeddings_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "product_embeddings_productId_unique": {
          "name": "product_embeddings_productId_unique",
          "columns": [
            "productId"
          ]
        }
      },
      "checkConstraint": {}
    },
    "products": {
      "name": "products",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "asin": {
          "name": "asin",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "category": {
          "name": "category",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "subcategory": {
          "name": "subcategory",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "imageUrl": {
          "name": "imageUrl",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "price": {
          "name": "price",
          "type": "decimal(10,2)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "originalPrice": {
          "name": "originalPrice",
          "type": "decimal(10,2)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "currency": {
          "name": "currency",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "'GBP'"
        },
        "rating": {
          "name": "rating",
          "type": "decimal(3,2)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "reviewCount": {
          "name": "reviewCount",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 0
        },
        "availability": {
          "name": "availability",
          "type": "enum('in_stock','low_stock','out_of_stock')",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "'in_stock'"
        },
        "stockQuantity": {
          "name": "stockQuantity",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 100
        },
        "brand": {
          "name": "brand",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "features": {
          "name": "features",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "isFeatured": {
          "name": "isFeatured",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "products_id": {
          "name": "products_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "products_asin_unique": {
          "name": "products_asin_unique",
          "columns": [
            "asin"
          ]
        }
      },
      "checkConstraint": {}
    },
    "ranking_weights": {
      "name": "ranking_weights",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "name": {
          "name": "name",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'default'"
        },
        "alpha": {
          "name": "alpha",
          "type": "decimal(4,3)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'0.500'"
        },
        "beta": {
          "name": "beta",
          "type": "decimal(4,3)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'0.200'"
        },
        "gamma": {
          "name": "gamma",
          "type": "decimal(4,3)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'0.150'"
        },
        "delta": {
          "name": "delta",
          "type": "decimal(4,3)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'0.100'"
        },
        "epsilon": {
          "name": "epsilon",
          "type": "decimal(4,3)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'0.050'"
        },
        "isActive": {
          "name": "isActive",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": true
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "ranking_weights_id": {
          "name": "ranking_weights_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "search_logs": {
      "name": "search_logs",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "sessionId": {
          "name": "sessionId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "query": {
          "name": "query",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "queryEmbedding": {
          "name": "queryEmbedding",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "resultsCount": {
          "name": "resultsCount",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": 0
        },
        "responseTimeMs": {
          "name": "responseTimeMs",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "filters": {
          "name": "filters",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "search_logs_id": {
          "name": "search_logs_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "search_result_explanations": {
      "name": "search_result_explanations",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "searchLogId": {
          "name": "searchLogId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "productId": {
          "name": "productId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "position": {
          "name": "position",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "finalScore": {
          "name": "finalScore",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "semanticScore": {
          "name": "semanticScore",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "ratingScore": {
          "name": "ratingScore",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "priceScore": {
          "name": "priceScore",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "stockScore": {
          "name": "stockScore",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "recencyScore": {
          "name": "recencyScore",
          "type": "decimal(8,6)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "matchedTerms": {
          "name": "matchedTerms",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "explanation": {
          "name": "explanation",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "wasClicked": {
          "name": "wasClicked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "search_result_explanations_id": {
          "name": "search_result_explanations_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "session_interactions": {
      "name": "session_interactions",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "sessionId": {
          "name": "sessionId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "productId": {
          "name": "productId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "interactionType": {
          "name": "interactionType",
          "type": "enum('view','click','search_click','add_to_cart','purchase')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "searchQuery": {
          "name": "searchQuery",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "position": {
          "name": "position",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "session_interactions_id": {
          "name": "session_interactions_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "sessions": {
      "name": "sessions",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "sessionId": {
          "name": "sessionId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "userId": {
          "name": "userId",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "lastActiveAt": {
          "name": "lastActiveAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        },
        "expiresAt": {
          "name": "expiresAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "sessions_id": {
          "name": "sessions_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "sessions_sessionId_unique": {
          "name": "sessions_sessionId_unique",
          "columns": [
            "sessionId"
          ]
        }
      },
      "checkConstraint": {}
    },
    "users": {
      "name": "users",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "openId": {
          "name": "openId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "email": {
          "name": "email",
          "type": "varchar(320)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "loginMethod": {
          "name": "loginMethod",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "role": {
          "name": "role",
          "type": "enum('user','admin')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'user'"
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        },
        "lastSignedIn": {
          "name": "lastSignedIn",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "users_id": {
          "name": "users_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "users_openId_unique": {
          "name": "users_openId_unique",
          "columns": [
            "openId"
          ]
        }
      },
      "checkConstraint": {}
    }
  },
  "views": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "tables": {},
    "indexes": {}
  }
}